<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Guidance Popup</title>
    <style>
        .popup {
            display: none;
            position: fixed;
            top: 50px;
            right: 20px;
            width: 300px;
            background-color: #fff;
            border: 1px solid #ccc;
            padding: 20px;
            box-shadow: 0 0 10px rgba(0,0,0,0.5);
            z-index: 1000;
            overflow-y: auto;
            max-height: 80vh;
        }
        .popup h1 { color: #2c3e50; font-size: 1.5em; margin-top: 0; }
        .popup h2 { color: #34495e; font-size: 1.2em; }
        .popup ul { list-style-type: none; padding-left: 0; }
        .popup li { margin-bottom: 10px; }
        .close-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            padding: 5px 10px;
            background-color: #e74c3c;
            color: white;
            border: none;
            cursor: pointer;
        }
        .close-btn:hover { background-color: #c0392b; }
    </style>
</head>
<body>
    <div id="guidancePopup" class="popup">
        <button class="close-btn" onclick="closePopup()">Close</button>
        <h1>Treasury & Investment Analysis User Guidance</h1>

        <h2>Step-by-Step Guide</h2>
        <ul>
            <li>Click the 'Guidance' button to open this popup</li>
            <li>Ensure an active internet connection</li>
            <li>Prepare a CSV file with 'Date', 'Inflow', and 'Outflow' columns</li>
            <li>Locate the 'Upload Cash Flow Data (CSV)' section</li>
            <li>Click 'Choose File' to select your CSV</li>
            <li>Submit by clicking the upload area or pressing 'Enter'</li>
            <li>Select 'Use Sample Data' checkbox if no CSV is available</li>
            <li>Check the 'Detected Columns' list after uploading</li>
            <li>Choose 'Date Column' from the dropdown menu</li>
            <li>Pick 'Inflow Column' from the dropdown menu</li>
            <li>Select 'Outflow Column' from the dropdown menu</li>
            <li>Verify the 'Standardized Data' table for correct mappings</li>
            <li>Adjust the 'Forecast Periods (Months)' slider (1-24 months)</li>
            <li>Set the 'Growth Rate' slider (0.0-0.1)</li>
            <li>Check 'Use Current 10-Year Treasury Yield' or set 'Discount Rate' slider (0.05-0.15)</li>
            <li>Enter 'Initial Investment' in the number input</li>
            <li>Slide risk factors (Policy, Intermittency, Market, Operational) for RARM</li>
            <li>Review 'Cash Flow Forecast', 'DCF Valuation', 'RARM', and 'Sensitivity Analysis' results</li>
            <li>Scroll to 'Visualizations' for 'Cash Flow Forecast' chart</li>
            <li>View 'Sensitivity Analysis' heatmap below the chart</li>
            <li>Go to 'Download Report' section</li>
            <li>Click 'Download Report (Excel Only)' for Excel data</li>
            <li>Click 'Download All Data (ZIP)' for ZIP with data and charts</li>
        </ul>

        <h2>Data Requirements</h2>
        <ul>
            <li>CSV file must include a 'Date' column in YYYY-MM-DD format</li>
            <li>'Inflow' column must contain numeric values for incoming cash</li>
            <li>'Outflow' column must contain numeric values for outgoing cash</li>
            <li>Ensure no special characters or blank rows in the CSV</li>
            <li>Sample data is available if no file is uploaded</li>
        </ul>
    </div>

    <script>
        function openPopup() {
            document.getElementById('guidancePopup').style.display = 'block';
        }
        function closePopup() {
            document.getElementById('guidancePopup').style.display = 'none';
        }
    </script>
</body>
</html>
